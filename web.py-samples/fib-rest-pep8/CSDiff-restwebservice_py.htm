<HTML><HEAD><TITLE> Differences Analysis</TITLE></HEAD><BODY BGCOLOR=WHITE><h3>Base file: J:\@Vyper Logix Corp\@Projects\python-projects\web.py-samples\fib-rest\restwebservice.py</h3><h3>Compared file: J:\@Vyper Logix Corp\@Projects\python-projects\web.py-samples\fib-rest\@restwebservice.py</h3><body onunload=exit()><form method="POST">  <p align="center"><i><font size="3">Generated by   <a href="http://www.ComponentSoftware.com/products/csdiff/" target="_blank">CSDiff</a> on  5/14/2013 4:19 PM</font></i>&nbsp;&nbsp;
  <input type="button" value="Navigate Changes" name="Navigate" onclick=pop_navigate()></p></form></body><html>
<style type="text/css">
<!--
.HDNormal {  }
.HDDeleted {  color: #00ff00;background:  #ffffff;text-decoration:line-through ; font-family: Courier New ; font-size: 10pt;}
.HDAdded {  color: #000000;background:  #ffff00;text-decoration:none ; font-family: Courier New ; font-size: 10pt;}
-->
</style>
<body>
<pre>
 <span class="HDNormal">
"""
As part of your screening, please provide a sample project for review:
1. The project should provide a RESTful web service.
  a. The web service accepts a number, n, as input and returns the first n Fibonacci numbers, starting from 0. I.e. given n = 5, appropriate output would represent the sequence "0 1 1 2 3".
  b. Given a negative number, it will respond with an appropriate error.
  c. The service should return the values in an XML document.  Create an XSD that can be used to validate the output.

&lt;fibonacci&gt;
            &lt;value index="0"&gt;0&lt;/value&gt;
            &lt;value index="1"&gt;1&lt;/value&gt;
            &lt;value index="2"&gt;1&lt;/value&gt;
            &lt;value index="3"&gt;2&lt;/value&gt;
&lt;/fibonacci&gt;

2. Set this project up on Github.  Include whatever instructions are necessary to build and deploy/run the project, where "deploy/run" means the web service is accepting requests and responding to them as appropriate.
3. While this project is admittedly trivial, approach it as representing a more complex problem that you'll have to put into production and maintain for 5 years.
"""
import sys
import web

import Queue
import threading

urls = (
    '/', 'Index',
    '/(\d+)', 'View',
    '/XML/(\d+)', 'ViewXML',
)

#<a name="diff" id="c0"><span class="HDDeleted">##</span></a> Templates
render = web.template.render('templates', base='base')

web.template.Template.globals.update(dict(
    datestr<a name="diff" id="c1"><span class="HDDeleted"> = </span></a><span class="HDAdded">=</span>web.datestr,
    render<span class="HDDeleted"> = </span><span class="HDAdded">=</span>render
))

<a name="diff" id="c2"><span class="HDAdded">
</span></a>def notfound():
    return web.notfound("Sorry, the page you were looking for was not found.  This message may be seen whenever someone tries to issue a negative number as part of the REST URL Signature and this is just not allowed at this time.")

<a name="diff" id="c3"><span class="HDAdded">
</span></a>class Index:

    def GET(self):
        """ Show page """
        return render.index()

<a name="diff" id="c4"><span class="HDAdded">
</span></a>class View:

    def GET(self, num):
        from utils import get_fibonacci_nums
        items = get_fibonacci_nums(num)
        return render.view(items)

<a name="diff" id="c5"><span class="HDAdded">
</span></a>class ViewXML:

    def __render__(self, values):
        __items__ = ['&lt;fibonacci&gt;']
        count = 0
        for v in values:
            __items__.append('&lt;value index="%s"&gt;%s&lt;/value&gt;' % (count,<a name="diff" id="c6"><span class="HDAdded"> </span></a>v))
            count += 1
        __items__.append('&lt;/fibonacci&gt;')
        return ''.join(__items__)
    
    def GET(self, num):
        from utils import get_fibonacci_nums
        items = get_fibonacci_nums(num)
        web.header('Content-Type', 'application/xml')
        return self.__render__(items)

app = web.application(urls, globals())
app.notfound = notfound

<a name="diff" id="c7"><span class="HDAdded">
</span></a>def unit_tests():
    import time
    import urllib2
    from xml.dom import minidom

    def begin_tests(url):
        print url
        foo = urllib2.urlopen(url).read()
        print 'Test #1'
        try:
            assert foo == '&lt;fibonacci&gt;&lt;value index="0"&gt;0&lt;/value&gt;&lt;value index="1"&gt;1&lt;/value&gt;&lt;value index="2"&gt;1&lt;/value&gt;&lt;value index="3"&gt;2&lt;/value&gt;&lt;value index="4"&gt;3&lt;/value&gt;&lt;/fibonacci&gt;', 'ERROR: Test #1 FAILED !!!'
            try:
                print 'Test #2 - Determine if the XML can be parsed ?!?', 
                xmldoc = minidom.parseString(foo)
                print ' PASSED !!!  Able to parse the XML so it must be well formed or so the theory goes at this point.'
                nodes = xmldoc.firstChild.childNodes
                print 'Test #3 - Determine if the XML contains 5 nodes ?!?'
                assert len(nodes) == 5, 'ERROR: Test #3 FAILED !!!'
                print 'Unit Test Recap - (1) The XML was exactly as expected AND it is seemingly well-formed therfore all is right in the universe.'
            except Exception, ex:
                print " FAILED (Reason: %s) !!!  Not-Able to parse the XML so it must NOT be all that well formed, and that's just too bad, isn't it ?" % (ex)
        except:
            pass
        print foo
        print 'Unit test(s) are done !!!'
        try:
            t._Thread__stop()
            print 'Thread Terminated !!!'
        except:
            pass
        
    port = sys.argv[1]
    url = 'http://127.0.0.1:%s/XML/5'<a name="diff" id="c8"><span class="HDDeleted">%</span></a><span class="HDAdded"> % </span>(port)
    t = threading.Thread(target=begin_tests, args=[url])
    t.daemon = False
    print 'Unit Test(s) begin in 5 secs...'
    time.sleep(5)
    t.start()
    
if __name__ == '__main__':
    def begin_web_server():
        app.run()
    
    t = threading.Thread(target=begin_web_server)
    t.daemon = False
    t.start()
    
    unit_tests()
<a name="diff" id="c9"><span class="HDDeleted">    </span></a></span>
</pre>
</body>
<SCRIPT LANGUAGE="JavaScript" TYPE="text/javascript">
<!--
var newWind;
function putJumpCode(){
	var cnt = 10;
	newWind.document.write('<html>\n');
	newWind.document.write('<title>CSDiff Navigation</title>\n');
	newWind.document.write('<body>\n');
	newWind.document.write('<form name="jump">\n');
	newWind.document.write('<input type="button" value=" |&lt; " name="First" onclick=goto_first(this.form)>&nbsp;')
	newWind.document.write('<input type="button" value=" &lt; " name="Prev" onclick=goto_prev(this.form)>&nbsp;&nbsp;\n');
	newWind.document.write('<select name=url onchange=menu_goto(this.form)> \n');
	for (var i=0; i<cnt ;i++ ) {
		newWind.document.write('<option value="#c'+i+'">Change #'+(i+1)+ '</option> \n');
		}
	newWind.document.write('');
	newWind.document.write('</select>&nbsp;&nbsp;\n');
	newWind.document.write('<input type="button" value=" &gt; " name="Next"\n');
	newWind.document.write('onclick=goto_next(this.form)>\n');
	newWind.document.write('<input type="button" value=" &gt| " name="Last"\n');
	newWind.document.write('onclick=goto_last(this.form)>\n');
	newWind.document.write('</form>\n');
	newWind.document.write('');
	newWind.document.write('<form method="POST">\n');
	newWind.document.write('<p align="center"><i><font size="3">Generated\n');
	newWind.document.write('by <a href="http://www.ComponentSoftware.com/products/csdiff/" target="_blank">CSDiff</a> \n');
	newWind.document.write('</form>\n');
	newWind.document.write('</body>\n');
	newWind.document.write('</html>\n');
	newWind.document.write('<SCRIPT LANGUAGE="JavaScript" TYPE="text/javascript">\n');
	newWind.document.write('<!--\n');
	newWind.document.write('');
	newWind.document.write('var directCloseFlag=1;\n');
	newWind.document.write('');
	newWind.document.write('function menu_goto( menuform )\n');
	newWind.document.write('{\n');
	newWind.document.write('  var baseurl = opener.location.href ;\n');
	newWind.document.write('  var idx = baseurl.indexOf("#");\n');
	newWind.document.write('  if (idx > -1) {\n');
	newWind.document.write('	baseurl = baseurl.slice(0, idx);\n');
	newWind.document.write('  }');
	newWind.document.write('  selecteditem = menuform.url.selectedIndex ;\n');
	newWind.document.write('  newurl = menuform.url.options[ selecteditem ].value ;\n');
	newWind.document.write('  if (newurl.length != 0) {\n');
	newWind.document.write('    	opener.top.location.href = baseurl + newurl ;\n');
	newWind.document.write('  }');
	newWind.document.write('}');
	newWind.document.write('');
	newWind.document.write('function goto_prev( menuform )\n');
	newWind.document.write('{\n');
	newWind.document.write('	if(menuform.url.selectedIndex>0) menuform.url.selectedIndex--;\n');
	newWind.document.write('	menu_goto( menuform )\n');
	newWind.document.write('}');
	newWind.document.write('');
	newWind.document.write('function goto_first( menuform )\n');
	newWind.document.write('{\n');
	newWind.document.write('	menuform.url.selectedIndex = 0;	\n');
	newWind.document.write('	menu_goto( menuform );\n');
	newWind.document.write('}');
	newWind.document.write('');
	newWind.document.write('function goto_last( menuform )\n');
	newWind.document.write('{\n');
	newWind.document.write('	menuform.url.selectedIndex = menuform.url.options.length-1;	\n');
	newWind.document.write('	menu_goto( menuform );\n');
	newWind.document.write('}');
	newWind.document.write('');
	newWind.document.write('function goto_next( menuform )\n');
	newWind.document.write('{\n');
	newWind.document.write('	if(menuform.url.options.length > (menuform.url.selectedIndex+1))\n');
	newWind.document.write('	menuform.url.selectedIndex++;\n');
	newWind.document.write('	menu_goto( menuform )\n');
	newWind.document.write('}');
	newWind.document.write('');
	newWind.document.write('function restore()\n');
	newWind.document.write('{\n');
	newWind.document.write('    	focus();\n');
	newWind.document.write('	menu_goto(jump);\n');
	newWind.document.write('}');
	newWind.document.write('');
	newWind.document.write('goto_first(jump)\n');
	newWind.document.write('//-->\n');
	newWind.document.write('<');
	newWind.document.write('/SCRIPT>\n');
}
function pop_navigate(){
var isOpen = false
try {
isOpen = (newWind != null) && (!newWind.closed)
} catch (e) {}
  if (!isOpen) {
    newWind =  window.open("" ,"HtmlDiffJumpWindow","width=270,height=40")
    if (newWind.opener == null) { // for Nav 2.0x
      newWind.opener = self // this creates and sets a new prop
    }	putJumpCode();
  
} 
else 
{	newWind.execScript("restore()", "JavaScript");
  }
}
function exit(){
var isOpen = false
try {
isOpen = (newWind != null) && (!newWind.closed)
} catch (e) {}
if (isOpen) {
	newWind.close();
  }
}
//--></SCRIPT></html>
</BODY></HTML>